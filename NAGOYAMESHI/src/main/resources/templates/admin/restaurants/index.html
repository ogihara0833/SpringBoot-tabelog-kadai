<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">
  <head>
    <div th:replace="~{fragment :: meta}"></div>
    <div th:replace="~{fragment :: styles}"></div>
    <title>Â∫óËàó‰∏ÄË¶ß</title>
  </head>
  <body>
    <div class="nagoyameshi-wrapper">
      <div th:replace="~{fragment :: header}"></div>
      <main>
        <div class="container pt-4 pb-5 nagoyameshi-container">
          <div class="row justify-content-center">
            <div class="col-xxl-9 col-xl-10 col-lg-11">
              <h1 class="mb-4 text-center">Â∫óËàó‰∏ÄË¶ß</h1>

              <!-- üîç Ê§úÁ¥¢„Éï„Ç©„Éº„É† -->
              <div class="d-flex justify-content-between align-items-end flex-wrap">
                <form method="get" th:action="@{/admin/restaurants}" class="mb-3">
                  <div class="input-group">
                    <input type="text" class="form-control" name="keyword" th:value="${keyword}" placeholder="Â∫óËàóÂêç">
                    <button type="submit" class="btn text-white shadow-sm nagoyameshi-btn">Ê§úÁ¥¢</button>
                  </div>
                </form>
                <a th:href="@{/admin/restaurants/register}" class="btn text-white shadow-sm mb-3 nagoyameshi-btn">Êñ∞Ë¶èÁôªÈå≤</a>
              </div>

              <!-- ‚úÖ „É°„ÉÉ„Çª„Éº„Ç∏Ë°®Á§∫ -->
              <div th:if="${successMessage}" class="alert alert-info">
                <span th:text="${successMessage}"></span>
              </div>

              <!-- üìã Â∫óËàó‰∏ÄË¶ß„ÉÜ„Éº„Éñ„É´ -->
              <table class="table">
				<thead>
				  <tr>
				    <th>ID</th>
				    <th>Â∫óËàóÂêç</th>
				    <th>‰ΩèÊâÄ</th>
				    <th>„Ç∏„É£„É≥„É´</th>
				    <th>‰æ°Ê†ºÂ∏Ø</th>
				    <th>Âñ∂Ê•≠ÊôÇÈñì</th>
				    <th></th>
				    <th></th>
				  </tr>
				</thead>
                <tbody>
                  <tr th:each="restaurant : ${restaurantPage.content}">
                    <td th:text="${restaurant.id}"></td>
                    <td th:text="${restaurant.name}"></td>
                    <td th:text="${restaurant.address}"></td>
                    <td th:text="${restaurant.category.name}"></td>
					<td>
					  <span th:if="${restaurant.lunchStart != null and restaurant.lunchEnd != null}"
					        th:text="'ÊòºÔºö' + ${#temporals.format(restaurant.lunchStart, 'HH:mm')} + '„Äú' + ${#temporals.format(restaurant.lunchEnd, 'HH:mm')}"></span>
					  <br th:if="${restaurant.dinnerStart != null and restaurant.dinnerEnd != null}" />
					  <span th:if="${restaurant.dinnerStart != null and restaurant.dinnerEnd != null}"
					        th:text="'Â§úÔºö' + ${#temporals.format(restaurant.dinnerStart, 'HH:mm')} + '„Äú' + ${#temporals.format(restaurant.dinnerEnd, 'HH:mm')}"></span>
					</td>
					<td>
					  <span th:if="${restaurant.lunchPriceMin != null and restaurant.lunchPriceMax != null}"
					        th:text="'ÊòºÔºö' + ${restaurant.lunchPriceMin} + '„Äú' + ${restaurant.lunchPriceMax} + 'ÂÜÜ'"></span>
					  <br th:if="${restaurant.dinnerPriceMin != null and restaurant.dinnerPriceMax != null}" />
					  <span th:if="${restaurant.dinnerPriceMin != null and restaurant.dinnerPriceMax != null}"
					        th:text="'Â§úÔºö' + ${restaurant.dinnerPriceMin} + '„Äú' + ${restaurant.dinnerPriceMax} + 'ÂÜÜ'"></span>
					</td>
                    <td>
						<a class="btn btn-sm btn-outline-primary"
						   th:href="@{/admin/restaurants/{id}/edit(id=${restaurant.id})}">
						  Á∑®ÈõÜ
						</a>
                    </td>
                    <td>
                      <a href="#" class="text-danger" data-bs-toggle="modal" th:data-bs-target="${'#deleteRestaurantModal' + restaurant.id}">ÂâäÈô§</a>
                    </td>
                    <!-- „É¢„Éº„ÉÄ„É´ -->
                    <div class="modal fade" th:id="${'deleteRestaurantModal' + restaurant.id}" tabindex="-1">
                      <div class="modal-dialog">
                        <div class="modal-content">
                          <div class="modal-header">
                            <h5 class="modal-title" th:text="${restaurant.name + ' „ÇíÂâäÈô§„Åó„Å¶„ÇÇ„Çà„Çç„Åó„ÅÑ„Åß„Åô„ÅãÔºü'}"></h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                          </div>
                          <div class="modal-footer">
							<form method="post" th:action="@{/admin/restaurants/{id}/delete(id=${restaurant.id})}">
							  <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
							  <button type="submit" class="btn btn-danger">ÂâäÈô§</button>
							</form>
                          </div>
                        </div>
                      </div>
                    </div>
                  </tr>
                </tbody>
              </table>

              <!-- ‚è© „Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥ -->
              <div th:if="${restaurantPage.totalPages > 1}" class="d-flex justify-content-center">
                <ul class="pagination">
                  <li class="page-item">
                    <a class="page-link" th:if="${!restaurantPage.first}" th:href="@{/admin/restaurants(page=${restaurantPage.number - 1}, keyword=${keyword})}">Ââç</a>
                    <span class="page-link disabled" th:if="${restaurantPage.first}">Ââç</span>
                  </li>
                  <li th:each="i : ${#numbers.sequence(0, restaurantPage.totalPages - 1)}" class="page-item">
                    <a class="page-link" th:href="@{/admin/restaurants(page=${i}, keyword=${keyword})}" th:text="${i + 1}" th:classappend="${i == restaurantPage.number} ? ' active' : ''"></a>
                  </li>
                  <li class="page-item">
                    <a class="page-link" th:if="${!restaurantPage.last}" th:href="@{/admin/restaurants(page=${restaurantPage.number + 1}, keyword=${keyword})}">Ê¨°</a>
                    <span class="page-link disabled" th:if="${restaurantPage.last}">Ê¨°</span>
                  </li>
                </ul>
              </div>

            </div>
          </div>
        </div>
      </main>
      <div th:replace="~{fragment :: footer}"></div>
    </div>
    <div th:replace="~{fragment :: scripts}"></div>
  </body>
</html>
