<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">
<head>
  <div th:replace="~{fragment :: meta}"></div>
  <div th:replace="~{fragment :: styles}"></div>
  <title>Â∫óËàó‰∏ÄË¶ß</title>
</head>
<body>
<div class="nagoyameshi-wrapper">
  <div th:replace="~{fragment :: header}"></div>

  <main>
    <div class="container pt-4 pb-5 nagoyameshi-container">
      <div class="row justify-content-center">
        <div class="col-xl-10">
          <h1 class="mb-4 text-center">Â∫óËàó‰∏ÄË¶ß</h1>

          <!-- üîç Ê§úÁ¥¢„Éï„Ç©„Éº„É† -->
          <form method="get" th:action="@{/restaurants}" class="mb-4">
            <div class="row g-3">
              <div class="col-md-3">
                <input type="text" class="form-control" name="keyword" placeholder="„Ç≠„Éº„ÉØ„Éº„Éâ"
                       th:value="${keyword}">
              </div>
              <div class="col-md-3">
                <select class="form-select" name="categoryId">
                  <option value="">„Ç´„ÉÜ„Ç¥„É™</option>
                  <option th:each="cat : ${categoryList}"
                          th:value="${cat.id}"
                          th:text="${cat.name}"
                          th:selected="${cat.id == categoryId}">
                  </option>
                </select>
              </div>
              <div class="col-md-2">
                <input type="number" class="form-control" name="maxBudget" placeholder="‰∫àÁÆó‰∏äÈôêÔºàÂÜÜÔºâ"
                       th:value="${maxBudget}">
              </div>
              <div class="col-md-2">
                <input type="text" class="form-control" name="area" placeholder="„Ç®„É™„Ç¢"
                       th:value="${area}">
              </div>
              <div class="col-md-2">
                <button type="submit" class="btn btn-primary w-100">Ê§úÁ¥¢</button>
              </div>
            </div>
          </form>

          <!-- üìã ‰∏ÄË¶ßË°®Á§∫ -->
          <table class="table">
            <thead>
              <tr>
                <th>Â∫óËàóÂêç</th>
                <th>„Ç∏„É£„É≥„É´</th>
                <th>‰ΩèÊâÄ</th>
                <th>‰æ°Ê†ºÂ∏Ø</th>
                <th>Âñ∂Ê•≠ÊôÇÈñì</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <tr th:each="restaurant : ${restaurantPage.content}">
                <td th:text="${restaurant.name}"></td>
                <td th:text="${restaurant.category.name}"></td>
                <td th:text="${restaurant.address}"></td>
                <td>
                  <span th:if="${restaurant.lunchPriceMin != null}" 
                        th:text="'ÊòºÔºö' + ${restaurant.lunchPriceMin} + '„Äú' + ${restaurant.lunchPriceMax} + 'ÂÜÜ'"></span>
                  <br th:if="${restaurant.dinnerPriceMin != null}" />
                  <span th:if="${restaurant.dinnerPriceMin != null}"
                        th:text="'Â§úÔºö' + ${restaurant.dinnerPriceMin} + '„Äú' + ${restaurant.dinnerPriceMax} + 'ÂÜÜ'"></span>
                </td>
                <td>
                  <span th:if="${restaurant.lunchStart != null}"
                        th:text="'ÊòºÔºö' + ${#temporals.format(restaurant.lunchStart, 'HH:mm')} + '„Äú' + ${#temporals.format(restaurant.lunchEnd, 'HH:mm')}"></span>
                  <br th:if="${restaurant.dinnerStart != null}" />
                  <span th:if="${restaurant.dinnerStart != null}"
                        th:text="'Â§úÔºö' + ${#temporals.format(restaurant.dinnerStart, 'HH:mm')} + '„Äú' + ${#temporals.format(restaurant.dinnerEnd, 'HH:mm')}"></span>
                </td>
                <td>
                  <a class="btn btn-sm btn-outline-primary"
                     th:href="@{/restaurants/{id}(id=${restaurant.id})}">Ë©≥Á¥∞</a>
                </td>
              </tr>
            </tbody>
          </table>

          <!-- ‚è© „Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥ -->
          <div th:if="${restaurantPage.totalPages > 1}" class="d-flex justify-content-center">
            <ul class="pagination">
              <li class="page-item" th:classappend="${restaurantPage.first} ? 'disabled'">
                <a class="page-link"
                   th:href="@{/restaurants(page=${restaurantPage.number - 1},
                                           keyword=${keyword},
                                           categoryId=${categoryId},
                                           maxBudget=${maxBudget},
                                           area=${area})}">Ââç</a>
              </li>
              <li th:each="i : ${#numbers.sequence(0, restaurantPage.totalPages - 1)}"
                  class="page-item" th:classappend="${i == restaurantPage.number} ? 'active'">
                <a class="page-link"
                   th:href="@{/restaurants(page=${i},
                                           keyword=${keyword},
                                           categoryId=${categoryId},
                                           maxBudget=${maxBudget},
                                           area=${area})}"
                   th:text="${i + 1}"></a>
              </li>
              <li class="page-item" th:classappend="${restaurantPage.last} ? 'disabled'">
                <a class="page-link"
                   th:href="@{/restaurants(page=${restaurantPage.number + 1},
                                           keyword=${keyword},
                                           categoryId=${categoryId},
                                           maxBudget=${maxBudget},
                                           area=${area})}">Ê¨°</a>
              </li>
            </ul>
          </div>

        </div>
      </div>
    </div>
  </main>

  <div th:replace="~{fragment :: footer}"></div>
</div>
<div th:replace="~{fragment :: scripts}"></div>
</body>
</html>
